/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/account.ts":
/*!************************!*\
  !*** ./src/account.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAccounts: () => (/* binding */ getAccounts),\n/* harmony export */   saveAccounts: () => (/* binding */ saveAccounts),\n/* harmony export */   updateBalancesExcel: () => (/* binding */ updateBalancesExcel),\n/* harmony export */   updateBalancesUI: () => (/* binding */ updateBalancesUI)\n/* harmony export */ });\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/**\n * Retrieve accounts from localStorage, or initialize defaults.\n */\nfunction getAccounts() {\n    return JSON.parse(localStorage.getItem(\"accounts\") || '{\"A\":200000,\"B\":200000}');\n}\n/**\n * Save accounts back to localStorage.\n */\nfunction saveAccounts(a) {\n    localStorage.setItem(\"accounts\", JSON.stringify(a));\n}\n/**\n * Update account balances in the HTML panel.\n */\nfunction updateBalancesUI() {\n    var a = getAccounts();\n    var d = document.getElementById(\"balances\");\n    if (d) {\n        d.innerHTML = \"\\n        <h4>Account Balances</h4>\\n        <table border=\\\"1\\\" style=\\\"width:100%;margin-top:5px;\\\">\\n            <tr><th>Account</th><th>Balance</th></tr>\\n            <tr><td>A</td><td>$\".concat(a.A.toLocaleString(), \"</td></tr>\\n            <tr><td>B</td><td>$\").concat(a.B.toLocaleString(), \"</td></tr>\\n        </table>\");\n    }\n}\n/**\n * Update the balances and payment history in Excel.\n */\nfunction updateBalancesExcel() {\n    return __awaiter(this, void 0, void 0, function () {\n        var a_1, err_1;\n        var _this = this;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    a_1 = getAccounts();\n                    // Ensure Excel runtime is ready\n                    if (!Office.context || typeof Excel === \"undefined\") {\n                        console.warn(\"‚ö†Ô∏è Excel runtime not ready ‚Äî retrying in 1s...\");\n                        setTimeout(updateBalancesExcel, 1000);\n                        return [2 /*return*/];\n                    }\n                    return [4 /*yield*/, Excel.run(function (ctx) { return __awaiter(_this, void 0, void 0, function () {\n                            var sheet, now, payments, rows, targetRange;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        sheet = ctx.workbook.worksheets.getActiveWorksheet();\n                                        // ‚úÖ Clear only our working range\n                                        sheet.getRange(\"F1:H100\").clear();\n                                        // --- Balances Section ---\n                                        sheet.getRange(\"F1:G1\").values = [[\"Account\", \"Balance\"]];\n                                        sheet.getRange(\"F2:G3\").values = [\n                                            [\"A\", a_1.A],\n                                            [\"B\", a_1.B]\n                                        ];\n                                        sheet.getRange(\"F1:G1\").format.font.bold = true;\n                                        now = new Date().toLocaleString();\n                                        sheet.getRange(\"F5\").values = [[\"Last Updated: \".concat(now)]];\n                                        payments = JSON.parse(localStorage.getItem(\"payments\") || \"[]\");\n                                        if (payments.length > 0) {\n                                            sheet.getRange(\"I1:L1\").values = [[\"Vendor\", \"Account\", \"Amount\", \"Date\"]];\n                                            rows = payments.map(function (p) { return [\n                                                p.vendor,\n                                                p.account,\n                                                p.amount,\n                                                new Date(p.date).toLocaleString(),\n                                            ]; });\n                                            targetRange = sheet.getRange(\"I2:L\".concat(rows.length + 1));\n                                            targetRange.values = rows;\n                                            // Formatting\n                                            sheet.getRange(\"I1:L1\").format.font.bold = true;\n                                            targetRange.format.autofitColumns();\n                                        }\n                                        return [4 /*yield*/, ctx.sync()];\n                                    case 1:\n                                        _a.sent();\n                                        console.log(\"‚úÖ Excel balances and payment history updated successfully\");\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })];\n                case 1:\n                    _a.sent();\n                    return [3 /*break*/, 3];\n                case 2:\n                    err_1 = _a.sent();\n                    console.error(\"‚ùå Excel update failed:\", err_1);\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/account.ts?\n}");

/***/ }),

/***/ "./src/app.ts":
/*!********************!*\
  !*** ./src/app.ts ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth */ \"./src/auth.ts\");\n/* harmony import */ var _vendor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./vendor */ \"./src/vendor.ts\");\n/* harmony import */ var _payment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./payment */ \"./src/payment.ts\");\n/* harmony import */ var _report__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./report */ \"./src/report.ts\");\n/* harmony import */ var _history__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./history */ \"./src/history.ts\");\n/* harmony import */ var _seed__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./seed */ \"./src/seed.ts\");\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./account */ \"./src/account.ts\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n\n\n\n\n\n\n/**\n * üîÅ Refresh vendor dropdowns dynamically and safely\n */\nfunction refreshVendorDropdowns() {\n    var vendors = JSON.parse(localStorage.getItem(\"vendors\") || \"[]\");\n    var vendorSelect = document.getElementById(\"vendor-select\");\n    var historyVendorSelect = document.getElementById(\"history-vendor-select\");\n    if (vendorSelect && historyVendorSelect) {\n        vendorSelect.innerHTML = \"<option value=\\\"\\\">Select Vendor</option>\";\n        historyVendorSelect.innerHTML = \"<option value=\\\"\\\">Select Vendor</option>\";\n        vendors.forEach(function (v) {\n            vendorSelect.innerHTML += \"<option value=\\\"\".concat(v.name, \"\\\">\").concat(v.name, \"</option>\");\n            historyVendorSelect.innerHTML += \"<option value=\\\"\".concat(v.name, \"\\\">\").concat(v.name, \"</option>\");\n        });\n    }\n}\n/**\n * ‚úÖ Main entry for Excel Add-in\n */\nOffice.onReady(function (info) { return __awaiter(void 0, void 0, void 0, function () {\n    var _a, _b, _c, _d, _e, _f, _g;\n    return __generator(this, function (_h) {\n        console.log(\"Office.js ready:\", info.host);\n        if (info.host !== Office.HostType.Excel) {\n            console.warn(\"‚ö†Ô∏è Not running in Excel host, skipping initialization.\");\n            return [2 /*return*/];\n        }\n        // Delay initialization slightly for Excel Online\n        if (!Office.context || typeof Excel === \"undefined\") {\n            console.warn(\"Excel runtime not ready ‚Äî retrying initialization...\");\n            setTimeout(function () { return location.reload(); }, 1500);\n            return [2 /*return*/];\n        }\n        // --- Initialize defaults ---\n        (0,_seed__WEBPACK_IMPORTED_MODULE_5__.initSeedData)();\n        (0,_account__WEBPACK_IMPORTED_MODULE_6__.updateBalancesUI)();\n        setTimeout(_account__WEBPACK_IMPORTED_MODULE_6__.updateBalancesExcel, 800);\n        // Populate vendor dropdowns\n        refreshVendorDropdowns();\n        // --- LOGIN ---\n        (_a = document.getElementById(\"login-btn\")) === null || _a === void 0 ? void 0 : _a.addEventListener(\"click\", function () {\n            var _a, _b;\n            var u = ((_a = document.getElementById(\"username\")) === null || _a === void 0 ? void 0 : _a.value) || \"\";\n            var p = ((_b = document.getElementById(\"password\")) === null || _b === void 0 ? void 0 : _b.value) || \"\";\n            (0,_auth__WEBPACK_IMPORTED_MODULE_0__.login)(u, p);\n        });\n        // --- LOGOUT ---\n        (_b = document.getElementById(\"logout-btn\")) === null || _b === void 0 ? void 0 : _b.addEventListener(\"click\", _auth__WEBPACK_IMPORTED_MODULE_0__.logout);\n        // --- ADD VENDOR ---\n        (_c = document.getElementById(\"add-vendor-btn\")) === null || _c === void 0 ? void 0 : _c.addEventListener(\"click\", function () {\n            var _a, _b;\n            var name = ((_a = document.getElementById(\"vendor-name\")) === null || _a === void 0 ? void 0 : _a.value.trim()) || \"\";\n            var account = (((_b = document.getElementById(\"account-select\")) === null || _b === void 0 ? void 0 : _b.value) || \"A\");\n            if (!name) {\n                (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"Please enter a vendor name.\");\n                return;\n            }\n            (0,_vendor__WEBPACK_IMPORTED_MODULE_1__.addVendor)(name, account);\n            // Clear input field\n            document.getElementById(\"vendor-name\").value = \"\";\n            // Refresh UI + Excel\n            refreshVendorDropdowns();\n            (0,_account__WEBPACK_IMPORTED_MODULE_6__.updateBalancesUI)();\n            setTimeout(_account__WEBPACK_IMPORTED_MODULE_6__.updateBalancesExcel, 500);\n            (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"\\u2705 Vendor \\\"\".concat(name, \"\\\" added successfully.\"));\n        });\n        // --- MAKE PAYMENT ---\n        (_d = document.getElementById(\"pay-btn\")) === null || _d === void 0 ? void 0 : _d.addEventListener(\"click\", function () {\n            var _a, _b;\n            var vendor = ((_a = document.getElementById(\"vendor-select\")) === null || _a === void 0 ? void 0 : _a.value) || \"\";\n            var amount = parseFloat(((_b = document.getElementById(\"payment-amount\")) === null || _b === void 0 ? void 0 : _b.value) || \"0\");\n            if (!vendor) {\n                (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"Please select a vendor.\");\n                return;\n            }\n            if (isNaN(amount) || amount <= 0) {\n                (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"Enter a valid payment amount.\");\n                return;\n            }\n            (0,_payment__WEBPACK_IMPORTED_MODULE_2__.makePayment)(vendor, amount);\n            // Clear input field\n            document.getElementById(\"payment-amount\").value = \"\";\n            // Update UI + Excel\n            (0,_account__WEBPACK_IMPORTED_MODULE_6__.updateBalancesUI)();\n            setTimeout(_account__WEBPACK_IMPORTED_MODULE_6__.updateBalancesExcel, 500);\n            (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"\\uD83D\\uDCB0 Payment of $\".concat(amount.toLocaleString(), \" made to \").concat(vendor, \".\"));\n        });\n        // --- VIEW HISTORY ---\n        (_e = document.getElementById(\"view-history-btn\")) === null || _e === void 0 ? void 0 : _e.addEventListener(\"click\", function () {\n            var _a;\n            var vendor = ((_a = document.getElementById(\"history-vendor-select\")) === null || _a === void 0 ? void 0 : _a.value) || \"\";\n            if (!vendor) {\n                (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"Select a vendor to view history.\");\n                return;\n            }\n            (0,_history__WEBPACK_IMPORTED_MODULE_4__.displayVendorHistory)(vendor);\n            document.getElementById(\"history-vendor-select\").selectedIndex = 0;\n        });\n        // --- GENERATE REPORT ---\n        (_f = document.getElementById(\"report-btn\")) === null || _f === void 0 ? void 0 : _f.addEventListener(\"click\", _report__WEBPACK_IMPORTED_MODULE_3__.generateReport);\n        // --- CLEAR ALL DATA ---\n        (_g = document.getElementById(\"clear-data-btn\")) === null || _g === void 0 ? void 0 : _g.addEventListener(\"click\", function () {\n            localStorage.clear();\n            (0,_ui__WEBPACK_IMPORTED_MODULE_7__.notify)(\"Local data cleared. Reloading...\");\n            location.reload();\n        });\n        console.log(\"‚úÖ Vendor Payment Manager initialized successfully.\");\n        return [2 /*return*/];\n    });\n}); });\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/app.ts?\n}");

/***/ }),

/***/ "./src/auth.ts":
/*!*********************!*\
  !*** ./src/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   login: () => (/* binding */ login),\n/* harmony export */   logout: () => (/* binding */ logout)\n/* harmony export */ });\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\n\nfunction login(username, password) {\n    var validUser = \"admin\";\n    var validPass = \"1234\";\n    // --- Check credentials ---\n    if (username === validUser && password === validPass) {\n        // Save user session\n        localStorage.setItem(\"user\", JSON.stringify({ username: username }));\n        // Hide login and show main content\n        var loginSection = document.getElementById(\"login-section\");\n        var mainSection = document.getElementById(\"main-section\");\n        if (loginSection)\n            loginSection.style.display = \"none\";\n        if (mainSection)\n            mainSection.style.display = \"block\";\n        (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"Login successful!\");\n    }\n    else {\n        (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"Invalid credentials. Try admin / 1234\");\n    }\n}\nfunction logout() {\n    localStorage.removeItem(\"user\");\n    location.reload();\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/auth.ts?\n}");

/***/ }),

/***/ "./src/history.ts":
/*!************************!*\
  !*** ./src/history.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   displayVendorHistory: () => (/* binding */ displayVendorHistory)\n/* harmony export */ });\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./account */ \"./src/account.ts\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\n\n\n/**\n * Displays vendor payment history in the task pane.\n * Also updates Excel to include the payment log.\n */\nfunction displayVendorHistory(vendorName) {\n    try {\n        var allPayments = JSON.parse(localStorage.getItem(\"payments\") || \"[]\");\n        if (!Array.isArray(allPayments)) {\n            console.warn(\"‚ö†Ô∏è Invalid payment data in localStorage\");\n            return;\n        }\n        var vendorPayments = allPayments.filter(function (p) { return p.vendor === vendorName; });\n        var container = document.getElementById(\"vendor-history\");\n        if (!container) {\n            console.warn(\"‚ö†Ô∏è Vendor history container not found in DOM\");\n            (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"Vendor history area not found ‚Äî please reload the Add-in.\");\n            return;\n        }\n        if (vendorPayments.length === 0) {\n            container.innerHTML = \"<p>No payments found for <strong>\".concat(vendorName, \"</strong>.</p>\");\n            return;\n        }\n        // Build HTML table\n        var rowsHtml = vendorPayments\n            .map(function (p) { return \"\\n            <tr>\\n                <td>\".concat(p.vendor, \"</td>\\n                <td>\").concat(p.account, \"</td>\\n                <td>$\").concat(p.amount.toLocaleString(), \"</td>\\n                <td>\").concat(new Date(p.date).toLocaleString(), \"</td>\\n            </tr>\"); })\n            .join(\"\");\n        var totalAmount = vendorPayments.reduce(function (sum, p) { return sum + p.amount; }, 0);\n        container.innerHTML = \"\\n            <h4>Payment History for <span style=\\\"color:#0078D7\\\">\".concat(vendorName, \"</span></h4>\\n            <table border=\\\"1\\\" style=\\\"width:100%;margin-top:10px;border-collapse:collapse;\\\">\\n                <tr style=\\\"background:#F3F3F3;\\\">\\n                    <th>Vendor</th><th>Account</th><th>Amount</th><th>Date</th>\\n                </tr>\\n                \").concat(rowsHtml, \"\\n            </table>\\n            <p style=\\\"margin-top:10px;font-weight:bold;\\\">Total: $\").concat(totalAmount.toLocaleString(), \"</p>\\n        \");\n        // Optional: update Excel log area\n        setTimeout(function () { return (0,_account__WEBPACK_IMPORTED_MODULE_0__.updateBalancesExcel)(); }, 500);\n    }\n    catch (err) {\n        console.error(\"‚ùå Failed to display vendor history:\", err);\n        (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"An error occurred while displaying vendor history.\");\n    }\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/history.ts?\n}");

/***/ }),

/***/ "./src/payment.ts":
/*!************************!*\
  !*** ./src/payment.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makePayment: () => (/* binding */ makePayment)\n/* harmony export */ });\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./account */ \"./src/account.ts\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\n\n\n/**\n * Handles vendor payment logic, updates balances,\n * saves payment record, refreshes Excel and UI.\n */\nfunction makePayment(vendorName, amount) {\n    try {\n        // --- Validate input ---\n        if (!(vendorName === null || vendorName === void 0 ? void 0 : vendorName.trim())) {\n            (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"Please select a vendor.\");\n            return;\n        }\n        if (isNaN(amount) || amount <= 0) {\n            (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"Please enter a valid payment amount.\");\n            return;\n        }\n        // --- Load vendor data ---\n        var vendors = JSON.parse(localStorage.getItem(\"vendors\") || \"[]\");\n        var vendor = vendors.find(function (v) { return v.name === vendorName; });\n        if (!vendor) {\n            (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"Vendor \\\"\".concat(vendorName, \"\\\" not found.\"));\n            return;\n        }\n        // --- Get accounts ---\n        var accounts = (0,_account__WEBPACK_IMPORTED_MODULE_0__.getAccounts)();\n        var accountKey = vendor.account;\n        if (accounts[accountKey] < amount) {\n            (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"Insufficient funds in Account \".concat(accountKey, \".\"));\n            return;\n        }\n        // --- Deduct from account ---\n        accounts[accountKey] -= amount;\n        (0,_account__WEBPACK_IMPORTED_MODULE_0__.saveAccounts)(accounts);\n        // --- Record payment history ---\n        var payments = [];\n        try {\n            payments = JSON.parse(localStorage.getItem(\"payments\") || \"[]\");\n            if (!Array.isArray(payments))\n                payments = [];\n        }\n        catch (_a) {\n            payments = [];\n        }\n        var newPayment = {\n            vendor: vendor.name,\n            account: vendor.account,\n            amount: amount,\n            date: new Date().toISOString(),\n        };\n        payments.push(newPayment);\n        localStorage.setItem(\"payments\", JSON.stringify(payments));\n        // --- Update UI and Excel ---\n        (0,_account__WEBPACK_IMPORTED_MODULE_0__.updateBalancesUI)();\n        // Slight delay so Excel API is ready (avoids RichApi errors)\n        setTimeout(function () {\n            (0,_account__WEBPACK_IMPORTED_MODULE_0__.updateBalancesExcel)();\n        }, 600);\n        // --- Success feedback ---\n        (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"\\uD83D\\uDCB0 Payment of $\".concat(amount.toLocaleString(), \" made to \").concat(vendor.name, \" from Account \").concat(vendor.account, \".\"));\n        console.log(\"‚úÖ Payment recorded:\", newPayment);\n    }\n    catch (err) {\n        console.error(\"‚ùå Error in makePayment:\", err);\n        (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"‚ö†Ô∏è An unexpected error occurred while processing the payment.\");\n    }\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/payment.ts?\n}");

/***/ }),

/***/ "./src/report.ts":
/*!***********************!*\
  !*** ./src/report.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateReport: () => (/* binding */ generateReport)\n/* harmony export */ });\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./account */ \"./src/account.ts\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n/**\n * Generates a combined Excel report showing:\n *  - Vendor payment history\n *  - Account balances\n *  - Timestamp of report creation\n */\nfunction generateReport() {\n    return __awaiter(this, void 0, void 0, function () {\n        var payments_1, accounts_1, err_1;\n        var _this = this;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    payments_1 = JSON.parse(localStorage.getItem(\"payments\") || \"[]\");\n                    accounts_1 = (0,_account__WEBPACK_IMPORTED_MODULE_0__.getAccounts)();\n                    if (!Office.context || typeof Excel === \"undefined\") {\n                        (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"‚ö†Ô∏è Excel runtime not ready ‚Äî please wait or reload.\");\n                        return [2 /*return*/];\n                    }\n                    return [4 /*yield*/, Excel.run(function (ctx) { return __awaiter(_this, void 0, void 0, function () {\n                            var sheet, headerRange, rows, targetRange, now;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        sheet = ctx.workbook.worksheets.getActiveWorksheet();\n                                        // --- Clear report area ---\n                                        sheet.getUsedRange().clear();\n                                        headerRange = sheet.getRange(\"A1:D1\");\n                                        headerRange.values = [[\"Vendor\", \"Account\", \"Amount\", \"Date\"]];\n                                        headerRange.format.font.bold = true;\n                                        headerRange.format.fill.color = \"#E3F2FD\";\n                                        if (payments_1.length > 0) {\n                                            rows = payments_1.map(function (p) { return [\n                                                p.vendor,\n                                                p.account,\n                                                p.amount,\n                                                new Date(p.date).toLocaleString(),\n                                            ]; });\n                                            targetRange = sheet.getRange(\"A2:D\".concat(rows.length + 1));\n                                            targetRange.values = rows;\n                                            targetRange.format.autofitColumns();\n                                        }\n                                        else {\n                                            sheet.getRange(\"A2\").values = [[\"(No payments recorded)\"]];\n                                        }\n                                        // --- Write balances table ---\n                                        sheet.getRange(\"F1:G1\").values = [[\"Account\", \"Balance\"]];\n                                        sheet.getRange(\"F2:G3\").values = [\n                                            [\"A\", accounts_1.A],\n                                            [\"B\", accounts_1.B],\n                                        ];\n                                        sheet.getRange(\"F1:G1\").format.font.bold = true;\n                                        now = new Date().toLocaleString();\n                                        sheet.getRange(\"A5\").values = [[\"Report generated: \".concat(now)]];\n                                        return [4 /*yield*/, ctx.sync()];\n                                    case 1:\n                                        _a.sent();\n                                        console.log(\"‚úÖ Excel report generated successfully\");\n                                        (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"üìä Report generated successfully in Excel.\");\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })];\n                case 1:\n                    _a.sent();\n                    return [3 /*break*/, 3];\n                case 2:\n                    err_1 = _a.sent();\n                    console.error(\"‚ùå Failed to generate report:\", err_1);\n                    (0,_ui__WEBPACK_IMPORTED_MODULE_1__.notify)(\"‚ö†Ô∏è Error generating report. Check console for details.\");\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/report.ts?\n}");

/***/ }),

/***/ "./src/seed.ts":
/*!*********************!*\
  !*** ./src/seed.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initSeedData: () => (/* binding */ initSeedData)\n/* harmony export */ });\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\n\n/**\n * Initializes localStorage with default accounts, vendors, and payments.\n * Safe to call multiple times ‚Äî will not create duplicates.\n */\nfunction initSeedData() {\n    try {\n        // --- Accounts ---\n        var storedAccounts = localStorage.getItem(\"accounts\");\n        if (!storedAccounts) {\n            localStorage.setItem(\"accounts\", JSON.stringify({ A: 200000, B: 200000 }));\n            console.log(\"‚úÖ Default accounts initialized.\");\n        }\n        // --- Vendors ---\n        var storedVendors = localStorage.getItem(\"vendors\");\n        if (!storedVendors) {\n            var defaultVendors = [\n                { name: \"ABC Supplies\", account: \"A\" },\n                { name: \"XYZ Contractors\", account: \"B\" },\n            ];\n            localStorage.setItem(\"vendors\", JSON.stringify(defaultVendors));\n            console.log(\"‚úÖ Default vendors initialized.\");\n        }\n        else {\n            // Clean duplicates if they exist\n            try {\n                var vendors = JSON.parse(storedVendors);\n                var unique = Array.from(new Map(vendors.map(function (v) { return [v.name.toLowerCase(), v]; })).values());\n                if (unique.length !== vendors.length) {\n                    localStorage.setItem(\"vendors\", JSON.stringify(unique));\n                    console.log(\"‚ôªÔ∏è Cleaned duplicate vendors.\");\n                }\n            }\n            catch (_a) {\n                console.warn(\"‚ö†Ô∏è Invalid vendor data, resetting.\");\n                localStorage.setItem(\"vendors\", JSON.stringify([\n                    { name: \"ABC Supplies\", account: \"A\" },\n                    { name: \"XYZ Contractors\", account: \"B\" },\n                ]));\n            }\n        }\n        // --- Payments ---\n        var storedPayments = localStorage.getItem(\"payments\");\n        if (!storedPayments) {\n            localStorage.setItem(\"payments\", JSON.stringify([]));\n            console.log(\"‚úÖ Empty payments initialized.\");\n        }\n        else {\n            try {\n                JSON.parse(storedPayments);\n            }\n            catch (_b) {\n                console.warn(\"‚ö†Ô∏è Invalid payment data, resetting.\");\n                localStorage.setItem(\"payments\", JSON.stringify([]));\n            }\n        }\n    }\n    catch (err) {\n        console.error(\"‚ùå Error initializing seed data:\", err);\n        (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"Error initializing default data ‚Äî see console.\");\n    }\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/seed.ts?\n}");

/***/ }),

/***/ "./src/ui.ts":
/*!*******************!*\
  !*** ./src/ui.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   notify: () => (/* binding */ notify)\n/* harmony export */ });\n/**\n * Display a simple message inside Excel taskpane (or console fallback).\n * @param message - The message to show\n * @param type - \"success\" | \"info\" | \"error\"\n */\nfunction notify(message, type) {\n    if (type === void 0) { type = \"info\"; }\n    var status = document.getElementById(\"status\");\n    if (status) {\n        // Color scheme for clarity\n        var color = \"#0078D7\"; // default info (blue)\n        if (type === \"success\")\n            color = \"#107C10\"; // green\n        if (type === \"error\")\n            color = \"#C50F1F\"; // red\n        status.textContent = message;\n        status.style.color = color;\n        status.style.fontWeight = \"500\";\n        // Auto-clear after 5 seconds\n        clearTimeout(status._timeout);\n        status._timeout = setTimeout(function () {\n            status.textContent = \"\";\n        }, 5000);\n    }\n    else {\n        // Fallback for dev/debug mode\n        var prefix = type === \"error\"\n            ? \"‚ùå\"\n            : type === \"success\"\n                ? \"‚úÖ\"\n                : \"‚ÑπÔ∏è\";\n        console.log(\"\".concat(prefix, \" \").concat(message));\n    }\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/ui.ts?\n}");

/***/ }),

/***/ "./src/vendor.ts":
/*!***********************!*\
  !*** ./src/vendor.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addVendor: () => (/* binding */ addVendor)\n/* harmony export */ });\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ui */ \"./src/ui.ts\");\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./account */ \"./src/account.ts\");\n\n\n/**\n * Add a new vendor to localStorage safely.\n * Prevents duplicates and syncs Excel balances.\n */\nfunction addVendor(name, account) {\n    try {\n        // --- Validation ---\n        var cleanName_1 = name.trim();\n        if (!cleanName_1) {\n            (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"Please enter a valid vendor name.\", \"error\");\n            return;\n        }\n        // --- Load vendor list safely ---\n        var vendors = [];\n        try {\n            vendors = JSON.parse(localStorage.getItem(\"vendors\") || \"[]\");\n            if (!Array.isArray(vendors))\n                vendors = [];\n        }\n        catch (_a) {\n            vendors = [];\n        }\n        // --- Prevent duplicates (case-insensitive) ---\n        var exists = vendors.some(function (v) { return v.name.toLowerCase() === cleanName_1.toLowerCase(); });\n        if (exists) {\n            (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"Vendor \\\"\".concat(cleanName_1, \"\\\" already exists.\"), \"error\");\n            return;\n        }\n        // --- Save new vendor ---\n        var newVendor = { name: cleanName_1, account: account };\n        vendors.push(newVendor);\n        localStorage.setItem(\"vendors\", JSON.stringify(vendors));\n        // --- UI and Excel update ---\n        (0,_account__WEBPACK_IMPORTED_MODULE_1__.updateBalancesUI)();\n        setTimeout(_account__WEBPACK_IMPORTED_MODULE_1__.updateBalancesExcel, 400);\n        // --- Notify success ---\n        (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"\\u2705 Vendor \\\"\".concat(cleanName_1, \"\\\" added to Account \").concat(account, \".\"), \"success\");\n        console.log(\"Vendor added:\", newVendor);\n    }\n    catch (err) {\n        console.error(\"‚ùå Error adding vendor:\", err);\n        (0,_ui__WEBPACK_IMPORTED_MODULE_0__.notify)(\"Failed to add vendor. See console for details.\", \"error\");\n    }\n}\n\n\n//# sourceURL=webpack://excel-vendor-payment-addin/./src/vendor.ts?\n}");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/app.ts");
/******/ 	
/******/ })()
;